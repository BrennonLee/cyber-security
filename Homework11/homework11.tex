\documentclass[12pt]{article}
\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}
\setlength{\textwidth}{6.5in}
\setlength{\parindent}{0in}
\setlength{\parskip}{\baselineskip}
\usepackage{amsmath,amsfonts,amssymb, siunitx}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{array}
\usepackage{fancyhdr}
\usepackage{listings}
\usepackage{flexisym}
\usepackage[table]{xcolor}
\usepackage[utf8]{inputenc}
\pagestyle{fancy}
%Code listing style named "mystyle"
\lstdefinestyle{mystyle}{
  basicstyle=\footnotesize,
  breakatwhitespace=false,
  breaklines=false,
  captionpos=b,
  keepspaces=false,
  numbers=left,
  numbersep=5pt,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,
  tabsize=2
}
%"mystyle" code listing set
\lstset{style=mystyle}
\begin{document}
\lhead{{\bf CSCI 3403 \\ Homework 11} }
\rhead{{\bf Brennon Lee  \\ Fall 2018, CU-Boulder}}
\renewcommand{\headrulewidth}{0.4pt}
\vspace{-3mm}
\begin{enumerate}
  % QUESTION 1
  \item \textbf{Question Not in the Book:}Consider the SNORT rule:
  \vspace{-1em}

  {\color{blue}
  \begin{verbatim}
  alert tcp $HOME_NET any <> $EXTERNAL_NET 6666:7000
  (msg:"CHAT IRC message"; flow:established;
  content:"PRIVMSG "; nocase; classtype:policy-violation;
  sid:1463; rev:6;)
  \end{verbatim}
  }
   Explain what the  snort rule does by answering:
   \begin{enumerate}
     \item What type of connections would the rule apply to?
     \item What type of traffic is being monitored?
     \item Is there any additional requirement on the traffic?
   \end{enumerate} \\

  \textbf{a) This rule applies only to established TCP connections.} \\
  \textbf{b) Any private messages going either direction from the HOME NET (on any port) to outside EXTERNAL NET Destination IP.} \\
  \textbf{c) The only outgoing traffic that is monitored will be ones that have destination ports between 6666 and 7000.} \\

  % QUESTION 2
  \item \textbf{Review Question 8.4} Describe the three logical components of an IDS.\\

  \textbf{Sensor - which has the role of collecting data. It's input includes network packets, log files, and system call traces.} \\

  \textbf{Analyzer - receives input from one or more sensors. It is responsible for determining if an intrusion has occured. The output of this component is an indication that an intrustion has occurred and could also include evidence supporting the conclusion.} \\

  \textbf{User Interface - enables the usre to view the output of the system or control the system behavior.} \\

  % QUESTION 3
  \item \textbf{Review Question 8.8} Explain the base-rate fallacy.\\

  \textbf{Base-rate fallacy is an error that occurs when the conditional probability of some hypothesis H (i.e. is this an intruder?), given some evidence E (Network data), is assessed without taking into account the prior probability of H and the total probability of evidence E. If the actual number of intrusions is low compared to the number of real users of a system, then the false alarm rate will be high unless the test is extremely discriminating.} \\

  % QUESTION 4
  \item \textbf{Problem 8.2} In the context of an IDS, we define a false positive to be an alarm generated by an IDS in which the IDS alerts to a condition that is actually benign. A false negative occurs when an IDS fails to generate an alarm when an alert-worthy condition is in effect. Using the following diagram, depict two curves that roughly indicate false positives and false negatives, respectively:\\

  \textbf{Answer} \\

  % QUESTION 5
  \item \textbf{Problem 8.3} \\

  \textbf{Answer} \\

  % QUESTION 6
  \item \textbf{Problem 8.4} One of the non-payload options in Snort is flow. This option distinguishes between clients and servers. This option can be used to specify a match only for packets flowing in one direction (client to server or visa-versa) and can specify a match only on established TCP connections. Consider the following Snort rule: \\

  {\color{blue}
  \begin{verbatim}
  alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS\
  (msg: ``ORACLE create database attempt:;\
  flow: to_server, established; content: ``create database‚Äù;
  nocase;\
  classtype: protocol-command-decode;)
  \end{verbatim}
  }

  \begin{enumerate}
  \item {What does this rule do?} \\

  \textbf{This rule will detect attempted attacks from established TCP connections. The source is any external net on any port and the direction is going from the source to destination. The destination is SQL servers and their oracle ports. This rule logs traffic that is atempting to create a database. The flow is used to match packets flowing to a server with an established TCP connection.} \\

  \item {Comment on the significance of this rule if the Snort devices is placed inside or outside of the external firewall.} \\

  \textbf{The amount of traffic logged would be significantly higher if this alert was placed outside of the firewall. If inside, there would be much less traffic logged since some invalid connection attempts are prevented by the firewall.} \\

  \end{enumerate}

  %Question 7
  \item \textbf{Problem 8.6}\\

  \textbf{Answer} \\


\end{enumerate}
\end{document}
